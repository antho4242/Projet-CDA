<%- include("../../partials/header", { title }) %>
<%- include("../../partials/nav") %>

<main class="container main">
  <div class="page-header">
    <h1><%- icon('package', 32) %> Gestion des produits</h1>
    <div style="display:flex; gap:10px">
      <a href="/dashboard/produits/ajouter" class="btn btn--primary"><%- icon('plus', 18) %> Ajouter</a>
      <a href="/dashboard" class="btn btn--ghost"><%- icon('back', 16) %> Dashboard</a>
    </div>
  </div>

  <div class="table-wrapper">
    <table class="table">
      <thead>
        <tr>
          <th>Référence</th>
          <th>Nom</th>
          <th>Prix</th>
          <th>Taille</th>
          <th>Catégorie</th>
          <th>Stock</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% produits.forEach(p => { %>
          <tr>
            <td><code><%= p.Reference %></code></td>
            <td><%= p.Nom_produit %></td>
            <td><%= parseFloat(p.Prix).toFixed(2) %> €</td>
            <td><%= p.Taille_produit %></td>
            <td><%= p.categorie %></td>
            <td class="<%= p.stock <= 5 ? 'text-danger' : '' %>">
              <%= p.stock ?? 'N/A' %>
            </td>
            <td style="display:flex; gap:8px">
              <a href="/dashboard/produits/modifier/<%= p.ID_produit %>"
                 class="btn btn--ghost btn--sm"><%- icon('edit', 16) %> Modifier</a>
              <form action="/dashboard/produits/supprimer/<%= p.ID_produit %>"
                    method="POST"
                    onsubmit="return confirm('Supprimer ce produit ?')">
                <button class="btn btn--danger btn--sm"><%- icon('trash', 16) %> Supprimer</button>
              </form>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</main>

<%- include("../../partials/footer") %>